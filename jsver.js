const jsData = [
    [
        "栏目名称",
        "访问url",
        "更新间隔",
        "列id",
        "父id",
        "type",
        "host:ip"
    ],
    [
        "图片新闻",
        "https://czj.chuzhou.gov.cn/",
        null,
        null,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "工作动态",
        "https://czj.chuzhou.gov.cn/czdt/czdt/index.html",
        14,
        5443728,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "县市区动态",
        "https://czj.chuzhou.gov.cn/czdt/xqdt/index.html",
        14,
        5443742,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "涉企政策",
        "https://czj.chuzhou.gov.cn/czdt/sqzc/index.html",
        180,
        5443754,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "通知公告",
        "https://czj.chuzhou.gov.cn/czdt/tzgg/index.html",
        180,
        5443806,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "公共信用",
        "https://czj.chuzhou.gov.cn/ztzl/ggxy/index.html",
        30,
        51557591,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "财经新闻",
        "https://czj.chuzhou.gov.cn/czdt/cjxw/index.html",
        14,
        5444251,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "财政收支分析",
        "https://czj.chuzhou.gov.cn/czdt/czszfx/index.html",
        30,
        11673033,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "政府预决算公开",
        "https://czj.chuzhou.gov.cn/czdt/zfyjsgk/index.html",
        180,
        15649889,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "机关党建工作",
        "https://czj.chuzhou.gov.cn/ztzl/index.html",
        30,
        null,
        35842110,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "八五普法",
        "https://czj.chuzhou.gov.cn/ztzl/index.html",
        30,
        37011249,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "依法行政",
        "https://czj.chuzhou.gov.cn/ztzl/index.html",
        30,
        37011277,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "文明创建",
        "https://czj.chuzhou.gov.cn/ztzl/index.html",
        30,
        null,
        54978783,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "扫黑除恶进行时",
        "https://czj.chuzhou.gov.cn/ztzl/index.html",
        30,
        81815035,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "减税降费",
        "https://czj.chuzhou.gov.cn/ztzl/index.html",
        30,
        122293640,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "政府采购（政府购买服务）专栏",
        "https://czj.chuzhou.gov.cn/ztzl/index.html",
        180,
        null,
        160685364,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "滁州会计网",
        "https://czj.chuzhou.gov.cn/ztzl/index.html",
        180,
        null,
        160685383,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "国有资产-通知公告",
        "https://czj.chuzhou.gov.cn/ztzl/sjgyzcgl/tzgg/index.html",
        180,
        160685391,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "国有资产-工作动态",
        "https://czj.chuzhou.gov.cn/ztzl/sjgyzcgl/gzdt/index.html",
        14,
        160685392,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "国有资产-政策法规",
        "https://czj.chuzhou.gov.cn/ztzl/sjgyzcgl/zcfg/index.html",
        180,
        160685395,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "国有资产-下载中心",
        "https://czj.chuzhou.gov.cn/ztzl/sjgyzcgl/xzzx/index.html",
        180,
        160685396,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        "反腐倡廉",
        "https://czj.chuzhou.gov.cn/ztzl/index.html",
        30,
        5444262,
        null,
        "内容管理",
        "59.203.54.81:8012"
    ],
    [
        null,
        null,
        null,
        null,
        null,
        null,
        null
    ],
    [
        "公开年报",
        null,
        365,
        121701,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "依申请公开",
        null,
        null,
        null,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "依申请公开目录",
        null,
        null,
        null,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "政策法规",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=2667882&action=list",
        180,
        2667882,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "重大决策预公开",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=8550430&action=list",
        180,
        8550430,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "规划计划",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=161734542&action=list",
        30,
        161734542,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "决策部署落实情况",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=5351999&action=list",
        30,
        5351999,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "建议提案办理",
        "https://www.chuzhou.gov.cn/public/content/1110548657",
        180,
        170072079,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "机构领导",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=161734757&action=list",
        365,
        161734757,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "机构设置",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=161731715&action=list",
        365,
        2667871,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "财政资金-年度财政预决算及“三公”经费情况",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&action=list&nav=&sub=&catId=161731869",
        180,
        161731869,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "财政资金-财政专项资金",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&action=list&nav=&sub=&catId=161732075",
        180,
        161732075,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "财政资金-部门项目",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&action=list&nav=&sub=&catId=161733536",
        365,
        161733536,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "权责清单和动态调整",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=161735039&action=list",
        180,
        161735039,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "公共服务清单和中介服务清单",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=161732374&action=list",
        365,
        161732374,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "“双随机一公开”",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=161732916&action=list",
        365,
        161732916,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "招标采购",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=161735369&action=list",
        180,
        161735369,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "行政权力运行-行政职权目录总表",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=2667885&action=list",
        365,
        2667885,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "行政权力运行-行政权力运行结果",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&action=list&nav=&sub=&catId=161732545",
        365,
        161732545,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "行政权力运行-行政许可和行政处罚双公示",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&action=list&nav=&sub=&catId=161732601",
        80,
        161732601,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "行政权力运行-行政执法公示",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&action=list&nav=&sub=&catId=161732614",
        365,
        161732614,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "新闻发布",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=2667905&action=list",
        180,
        2667905,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "上级政策解读",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=161733802&action=list",
        180,
        161733802,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "本级政策解读",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=161733868&action=list",
        180,
        161733868,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "回应关切",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=161734163&action=list",
        180,
        161734163,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "监督保障",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=161734264&action=list",
        180,
        161734264,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "精准脱贫",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=5350584&action=list",
        180,
        5350442,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        "网站年度报表",
        "https://www.chuzhou.gov.cn/public/column/2681665?type=4&catId=119361791&action=list",
        365,
        119361791,
        null,
        "政务公开",
        "59.203.54.81:8002"
    ],
    [
        null,
        null,
        null,
        null,
        null,
        null,
        "59.203.54.81:8002"
    ],
    [
        "年度财政预决算及“三公”经费情况",
        "https://www.chuzhou.gov.cn/public/column/152523227?type=4&catId=151964750&action=list",
        180,
        151964750,
        null,
        "政府办",
        "59.203.54.81:8002"
    ],
    [
        "财政专项资金-管理制度和财政专项资金清单",
        "https://www.chuzhou.gov.cn/public/column/152523227?type=4&action=list&nav=&sub=&catId=151966039",
        180,
        151966039,
        null,
        "政府办",
        "59.203.54.81:8002"
    ],
    [
        "财政专项资金-财政专项资金管理和使用情况",
        "https://www.chuzhou.gov.cn/public/column/152523227?type=4&action=list&nav=&sub=&catId=151966193",
        180,
        151966193,
        null,
        "政府办",
        "59.203.54.81:8002"
    ],
    [
        "财政收支情况",
        "https://www.chuzhou.gov.cn/public/column/152523227?type=4&catId=151966227&action=list",
        180,
        151966227,
        null,
        "政府办",
        "59.203.54.81:8002"
    ],
    [
        "政府债务",
        "https://www.chuzhou.gov.cn/public/column/152523227?type=4&catId=151966253&action=list",
        180,
        151966253,
        null,
        "政府办",
        "59.203.54.81:8002"
    ],
    [
        "行政事业性收费",
        "https://www.chuzhou.gov.cn/public/column/152523227?type=4&catId=170079788&action=list",
        180,
        170079788,
        null,
        "政府办",
        "59.203.54.81:8002"
    ],
    [
        "三大攻坚战-防范化解重大风险-政策文件",
        "https://www.chuzhou.gov.cn/public/column/152523227?type=4&action=list&nav=&sub=&catId=151968747",
        180,
        151968747,
        null,
        "政府办",
        "59.203.54.81:8002"
    ],
    [
        "三大攻坚战-防范化解重大风险-措施及成效",
        "https://www.chuzhou.gov.cn/public/column/152523227?type=4&action=list&nav=&sub=&catId=151968845",
        180,
        151968845,
        null,
        "政府办",
        "59.203.54.81:8002"
    ],
    [
        "三大攻坚战-脱贫攻坚-扶贫资金",
        "https://www.chuzhou.gov.cn/public/column/152523227?type=4&catId=151969361&action=list",
        180,
        151969361,
        null,
        "政府办",
        "59.203.54.81:8002"
    ],
    [
        "放管服改革-放管服-改革任务落实-减税降费",
        "https://www.chuzhou.gov.cn/public/column/152523227?type=4&catId=152565612&action=list",
        180,
        152565612,
        null,
        "政府办",
        "59.203.54.81:8002"
    ],
    [
        "社会公益事业-社会公益事业-减税降费",
        "https://www.chuzhou.gov.cn/public/column/152523227?type=4&catId=151975667&action=list",
        180,
        151975667,
        null,
        "政府办",
        "59.203.54.81:8002"
    ],
    [
        "公共资源配置-公共资源配置-政府采购-采购政策",
        "https://www.chuzhou.gov.cn/public/column/152523227?type=4&action=list&nav=&sub=&catId=151979869",
        180,
        151979869,
        null,
        "政府办",
        "59.203.54.81:8002"
    ],
    [
        "公共资源配置-公共资源配置-政府采购-投诉与监督检查",
        "https://www.chuzhou.gov.cn/public/column/152523227?type=4&action=list&nav=&sub=&catId=151979937",
        180,
        151979937,
        null,
        "政府办",
        "59.203.54.81:8002"
    ],
    [
        "公共资源配置-公共资源配置-政府采购-违法违规处罚信息",
        "https://www.chuzhou.gov.cn/public/column/152523227?type=4&action=list&nav=&sub=&catId=151979975",
        180,
        151979975,
        null,
        "政府办",
        "59.203.54.81:8002"
    ],
    [
        "政府购买服务及社会资本合作",
        "https://www.chuzhou.gov.cn/public/column/152523227?type=4&catId=151980626&action=list",
        180,
        151980626,
        null,
        "政府办",
        "59.203.54.81:8002"
    ],
    [
        "财政资金直达基层",
        "https://www.chuzhou.gov.cn/public/column/152523227?type=4&catId=170079657&action=list",
        180,
        170079657,
        null,
        "政府办",
        "59.203.54.81:8002"
    ]
]
const dataPostFetch = async (url, body) => {
    try {
        const resp = await fetch(url, {
            "headers": {
                "accept": "application/json, text/javascript, */*; q=0.01",
                "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6,zh-TW;q=0.5",
                "content-type": "application/x-www-form-urlencoded; charset=UTF-8",
                "x-requested-with": "XMLHttpRequest"
            },
            "referrerPolicy": "strict-origin-when-cross-origin",
            "body": body,
            "method": "POST",
            "mode": "cors",
            "credentials": "include"
        })
        const rawData = await resp.json()
        const sortedDate = rawData.data.sort((a, b) => new Date(b.publishDate) - new Date(a.publishDate))//按日期排列，确保最新，因为可能有固定的
        return [sortedDate[0].title, sortedDate[0].publishDate]
    } catch (e) {
        console.log(e)
        return [null, null]
    }
}

const getLatestZFB = async (catId) => {
    return await dataPostFetch(
        "http://59.203.54.81:8002/public/content/getPage?isAjax=1&dataType=json",
        `siteId=2653861&organId=152523227&type=DRIVING_PUBLIC&catId=${catId}&key=&startDate=&endDate=&attribute=ATTRIBUTE_OTHER&isPublish=1&pageIndex=0&pageSize=20&sortField=&sortOrder=`
    )
}
const getLatestZWGK = async (catId) => {
    return await dataPostFetch(
        "http://59.203.54.81:8002/public/content/getPage?isAjax=1&dataType=json",
        `siteId=2653861&organId=2681665&type=DRIVING_PUBLIC&catId=${catId}&key=&startDate=&endDate=&attribute=ATTRIBUTE_OTHER&isPublish=1&pageIndex=0&pageSize=20&sortField=&sortOrder=`
    )
}

const getLatestNRGL = async (columnId, parentId) => {
    return await dataPostFetch(
        `http://59.203.54.81:8012/content/${columnId ? "getPage" : "getPageByParentId"}?IsAjax=1&dataType=JSON&_=${Math.random()}`,
        `pageIndex=0&pageSize=10&dataFlag=1&columnId=${columnId ? columnId : parentId}&title=&conditionMap%5BisPublish%5D=1&startTime=&endTime=&isSelf=0&pagesize=10&condition=isPublish&status=1&isReferNews=`
    )
}



(async function () {
    for (item of jsData) {
        if (typeof item[2] === "number") {//更新间隔是数字
            if (item[6] === window.location.host) {
                let title, date;
                if (item[5] === "内容管理") {
                    [title, date] = await getLatestNRGL(item[3], item[4]);
                } else if (item[5] === "政务公开") {
                    [title, date] = await getLatestZWGK(item[3]);
                }else if (item[5] === "政府办") {
                    [title, date] = await getLatestZFB(item[3]);
                }
                const distance = Number.parseInt((new Date() - new Date(date)) / 86400000)
                const daysRemain = item[2] - distance
                const infoText = `${item[0]}\n${item[1]}\n${title}\n${date}\n距今${distance}天，剩余${daysRemain}天\n========================================`
                if (daysRemain <= 0) {
                    console.error(infoText)
                } else if (daysRemain <= 2){
                    console.warn(infoText)
                }else{
                    console.log(infoText)
                }
            }
        }
    }
    console.log("整完！")
})()


